Rewrite DataIndex to be fully functional, which will allow easier acceleration with Numba
