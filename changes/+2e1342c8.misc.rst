The header reading logic has been generalized to allow more flexibility in defining new data types
